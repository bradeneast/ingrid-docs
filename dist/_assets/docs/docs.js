(()=>{class x{constructor({onload:c=null,selector:d,cacheLimit:v,transitioningAttribute:k,preserveScroll:I=!1,preserveAttributes:p=!1}={}){d=d||`a[href^='${window.location.origin}']:not([data-no-schwifty]), a[href^='/']:not([data-no-schwifty])`,v=v||85,k=k||"data-schwifty";let w=p===!0;typeof p!="object"&&(p={documentElement:w,head:w,body:w});let l="schwifty-preload",m='link[rel="stylesheet"]',h=document,n=h.documentElement,q="innerHTML",i=new Map(),J=new IntersectionObserver((a,b)=>a.forEach(o=>{let s=o.isIntersecting,t=o.target.href;if(!s&&s!=void 0)return;i.size>=v&&i.delete(i.keys()[0]),i.get(t)?b.unobserve(o.target):L(t)}),{threshold:.5}),A=(a,b=h)=>b.querySelector(a),r=(a,b=h)=>b.querySelectorAll(a),K=a=>a.target.closest(d)||{},B=()=>r(d).forEach(a=>J.observe(a)),j=(a,b=window)=>b.dispatchEvent(new Event(a)),C=a=>a.replace(/m?s/gi,""),D=()=>{let a=getComputedStyle(n);return(C(a.transitionDelay)+C(a.transitionDuration))*1000},L=a=>{if(!a)return;let b=new XMLHttpRequest();b.onreadystatechange=function(){this.status==200&&i.set(a,b.responseXML)},b.open("GET",a,!0),b.responseType="document",b.send()},E=a=>{let b=i.get(a);if(!b){location=a;return}history.replaceState(null,null,a),r(`${m}:not(.${l})`).forEach(e=>{let f=e.href.replace(location.origin,""),g=A(`${m}.${l}[href="${f}"]`),F=A(`${m}[href="${f}"]`,b);F&&!g&&(e.classList.add(l),n.append(e)),!F&&g&&g.remove()});let o=`${m}:not(.${l})`,s=`${m}.${l}`,t=r(o,b),M=r(s);for(let e of M)Array.from(t).some(f=>f.href==e.href)||e.remove();["body","head","documentElement"].forEach(e=>{if(p[e])return;let f=h[e];for(let g of f.attributes)f.removeAttribute(g.name);for(let g of b[e].attributes)f.setAttribute(g.name,g.value)}),n.setAttribute(k,"out"),j("pagehide"),j("unload"),setTimeout(()=>{h.body[q]=b.body[q],h.head[q]=b.head[q],n.setAttribute(k,"in"),j("DOMContentLoaded",h),I||scrollTo(0,0),c&&(c.length?c.map(e=>e()):c()),B(),setTimeout(()=>n.removeAttribute(k),D()),j("load"),j("pageshow")},D())};B(),addEventListener("popstate",()=>E(location.href)),addEventListener("click",a=>{let b=K(a).href;b&&(a.preventDefault(),j("beforeunload"),history.pushState(null,null,location.href),E(b))})}}let G=(c,d=document)=>d.querySelector(c),H=(c,d=document)=>d.querySelectorAll(c),u=(c,d)=>d==void 0?JSON.parse(localStorage.getItem(c)):localStorage.setItem(c,JSON.stringify(d)),y=(c,d)=>document.documentElement.classList.toggle(c,d);function z(){y("dark",u("dark")),G("#theme-toggle").addEventListener("click",()=>{let c=u("dark");y("dark",!c),u("dark",!c)}),H("nav a").forEach(c=>{c.href==location.href&&c.setAttribute("aria-current",!0)})}z();new x({onload:z,preserveAttributes:!0});})();
